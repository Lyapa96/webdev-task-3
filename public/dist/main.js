!function(e){var t={};function c(n){if(t[n])return t[n].exports;var l=t[n]={i:n,l:!1,exports:{}};return e[n].call(l.exports,l,l.exports,c),l.l=!0,l.exports}c.m=e,c.c=t,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},c.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},c.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="",c(c.s=1)}([function(e){e.exports={}},function(e,t,c){"use strict";c.r(t);c(0);const n=info.URL;let l,s=!0,i=!0,a="";class o{constructor(e,t){this.place=e,this.index=t}setOnclick(){let e=document.querySelector(`.places_place-name-${this.place.id}`),t=document.querySelector(`.places_placeId-${this.place.id}`);t.onclick=(()=>{t.checked?(this.place.isVisited||this.updateOnServer({isVisited:!0}),e.style.textDecoration="line-through"):(this.place.isVisited&&this.updateOnServer({isVisited:!1}),e.style.textDecoration="none")}),document.querySelector(`.places__delete-one-${this.place.id}`).onclick=(()=>this.deletePlaceOnServer());let c=document.querySelector(`.places_place-name-${this.place.id}`),n=document.querySelector(`.places__edit-${this.place.id}`);document.querySelector(`.places__edit-one-${this.place.id}`).onclick=(()=>{document.querySelector(`.places__new-name-${this.place.id}`).value=this.place.name,c.style.display="none",n.style.display="block"}),document.querySelector(`.places__close-${this.place.id}`).onclick=(()=>{c.style.display="block",n.style.display="none"}),document.querySelector(`.places__save-${this.place.id}`).onclick=(()=>{let e=document.querySelector(`.places__new-name-${this.place.id}`).value;this.updateOnServer({name:e})}),document.querySelector(`.places__button-down-${this.place.id}`).onclick=(()=>{let e=this.getOtherId(1);this.shuffleOnServer(this.place.id,e)}),document.querySelector(`.places__button-up-${this.place.id}`).onclick=(()=>{let e=this.getOtherId(-1);this.shuffleOnServer(this.place.id,e)})}updateOnServer(e){const t={headers:{Accept:"application/json","Content-Type":"application/json"},method:"PATCH",body:JSON.stringify(e)};fetch(`${n}/place/${this.place.id}`,t).then(()=>fetch(n)).then(e=>e.json()).then(e=>{l.updatePlacesList(e)})}deletePlaceOnServer(){fetch(`${n}/?id=${this.place.id}`,{headers:{Accept:"application/json","Content-Type":"application/json"},method:"DELETE"}).then(()=>fetch(n)).then(e=>e.json()).then(e=>{l.updatePlacesList(e)})}getOtherId(e){let t=this.index+e;return t>=l.places.length&&(t=0),t<0&&(t=l.places.length-1),l.places[t].place.id}shuffleOnServer(e,t){fetch(`${n}/shuffle/?firstId=${e}&secondId=${t}`,{headers:{Accept:"application/json","Content-Type":"application/json"},method:"PATCH"}).then(()=>fetch(n)).then(e=>e.json()).then(e=>{l.updatePlacesList(e)})}}function r(){l.createPlace()}function p(){l.deleteAll()}function d(){s=!0,_()}function u(){s=!1,i=!0,_()}function h(){s=!1,i=!1,_()}function _(){l.updatePlacesList(l.places.map(e=>e.place))}window.onload=async function(){var e;l=new class{constructor(){this.places=[]}createPlace(){const e=document.querySelector(".create-place__name").value,t={headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify({name:e})};let c=this;return fetch(n,t).then(()=>fetch(n)).then(e=>e.json()).then(e=>{let t=e;c.updatePlacesList(t)})}getPlacesFromServer(){return fetch(n).then(e=>e.json()).then(e=>this.updatePlacesList(e))}updatePlacesList(e){this.places=e.filter(e=>null!==e).map((e,t)=>new o(e,t));let t=this.getListHtmlElement();t.innerHTML="",this.places.filter(this.placeFilter).filter(this.textFilter).forEach(e=>{t.innerHTML+=this.getPlaceInHtml(e.place)}),this.places.forEach(e=>{e.setOnclick()})}deleteAll(){this.places=[],document.querySelector(".places__list").innerHTML=""}getListHtmlElement(){return document.querySelector(".places__list")}getPlaceInHtml(e){return`<div class="places__list-one-place">\n            <button class="places__delete-one-${e.id}">\n            <img class="places__delete-one-img" src="images/deleteAll.png" alt="корзина">\n            </button>\n            <button class="places__edit-one-${e.id}">\n            <img class="places__edit-one-img" src="images/pencil.png" alt="карандаш ">\n            </button>\n\n                <div class="places_place-name-${e.id}" \n                style=text-decoration:${e.isVisited?"line-through":"none"}>\n                ${e.name} ${e.id} ${e.isVisited}</div>\n\n            <div class="places__edit-${e.id}" style=display:none>\n                <input class="places__new-name-${e.id}">\n                <button class="places__save-${e.id}">\n                <img class="places__save-img" src="images/green_galka.png" alt="галка">\n                </button>\n                <button class="places__close-${e.id}">\n                <img class="places__close-img" src="images/red_krest.png" alt="крест">\n                </button>\n            </div>\n\n            <button class="places__button-up-${e.id}" data-filter-state="all">вверх\n            </button>\n            <button class="places__button-down-${e.id}" data-filter-state="all">вниз\n            </button>\n            <input class="places_placeId-${e.id}" ${e.isVisited?"checked":""} \n            id="checkBox" type="checkbox">\n        </div>`}placeFilter(e){return!!s||(i?e.place.isVisited:!e.place.isVisited)}textFilter(e){return e.place.name.includes(a)}},await l.getPlacesFromServer(),document.querySelector(".create-place__button").onclick=r,document.querySelector(".places__delete-all").onclick=p,this.document.querySelector(".places__button-all").onclick=d,this.document.querySelector(".places__button-visited").onclick=u,this.document.querySelector(".places__button-not-visited").onclick=h,this.document.querySelector(".search__input").onkeydown=(e=>(e=e,a=e.target.value,void _()))}}]);